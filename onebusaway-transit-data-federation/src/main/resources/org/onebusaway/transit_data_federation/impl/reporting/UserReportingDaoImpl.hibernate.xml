<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <query name="stopProblemReportSummaries" read-only="true">
      SELECT p.stopId, count(*)
        FROM StopProblemReportRecord p
        WHERE p.stopId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
        GROUP BY p.stopId.id 
    </query>
    <query name="stopProblemReportSummariesWithStatus" read-only="true">
      SELECT p.stopId, count(*)
        FROM StopProblemReportRecord p
        WHERE p.stopId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
        AND p.status = :status
        GROUP BY p.stopId.id 
    </query>
    <query name="tripProblemReportSummaries" read-only="true">
      SELECT p.tripId, count(*)
        FROM TripProblemReportRecord p
        WHERE p.tripId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
        GROUP BY p.tripId.id 
    </query>
    <query name="tripProblemReportSummariesWithStatus" read-only="true">
      SELECT p.tripId, count(*)
        FROM TripProblemReportRecord p
        WHERE p.tripId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
        AND p.status = :status
        GROUP BY p.tripId.id 
    </query>    
    <query name="stopProblemReports" read-only="true">
      SELECT p
        FROM StopProblemReportRecord p
        WHERE p.stopId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
    </query>
    <query name="stopProblemReportsWithStatus" read-only="true">
      SELECT p
        FROM StopProblemReportRecord p
        WHERE p.stopId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
        AND p.status = :status
    </query>
    <query name="tripProblemReports" read-only="true">
      SELECT p
        FROM TripProblemReportRecord p
        WHERE p.tripId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
    </query>
    <query name="tripProblemReportsWithStatus" read-only="true">
      SELECT p
        FROM TripProblemReportRecord p
        WHERE p.tripId.agencyId = :agencyId
        AND :timeFrom &lt;= p.time
        AND p.time &lt; :timeTo
        AND p.status = :status
    </query>         
    <query name="allStopProblemReportsForStopId" read-only="true">
      SELECT p FROM StopProblemReportRecord p WHERE p.stopId = :stopId 
    </query>
	<query name="allTripProblemReportsForTripId" read-only="true">
      SELECT p FROM TripProblemReportRecord p WHERE p.tripId = :tripId 
    </query>
    <query name="allTripProblemReportLabels" read-only="true">
      SELECT p.label FROM TripProblemReportRecord p WHERE p.label != NULL GROUP BY p.label  
    </query>
    
</hibernate-mapping>
